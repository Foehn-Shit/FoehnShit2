<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>模组</title>
  <style>
    * {
      background-color: black;
      color: #d7d7d7;
      width: 100%;

    }

    #eqContainer {
      padding-left: 10px;
    }
  </style>
</head>

<body>
  <div id="eqContainer">
    |模组名=<span id="a51"></span><br />
    |模组解锁任务1=<span id="a52"></span><br />
    |模组解锁任务2=<span id="a53"></span><br />
    |模组解锁材料=<span id="a54"></span><br />
    |基础数值变化=<span id="a55"></span><br />
    |分支特性更新=<span id="a56"></span><br />
    <br />
    <br />
    <br />
    &#60;br/&#62;
    开启{{color|00b0ff|模组系统}}
    <br />
    {{模组/干员}}
    <br />
    <br />
    <span id="name0"></span><br />
    {{模组/个<br />
    |模组实装日期=<span id="r25"></span><br />
    |equipId=<span id="l1"></span><br />
    |模组名=<span id="df1"></span><br />
    |所属干员=<span id="df4"></span><br />
    |顺序=<span id="sq1"></span><br />
    |图片名=证章<br />
    |类型=<span id="df2"></span><br />
    |描述=<span id="df3"></span><br />
    }}<br />
    <br />
    <br />
    <br />
    <span id="name1"></span><br />
    <!-- &nbsp;-->{{模组/个<br />
    |模组名=<span id="r21"></span><br />
    |equipId=<span id="l2"></span><br />
    |所属干员=<span id="df5"></span><br />
    |模组实装日期=<span id="r23"></span><br />
    |升级系统实装日期=<span id="r24"></span><br />
    |顺序=<span id="sq2"></span><br />
    |图片名=<span id="r14"></span><br />
    |类型=<span id="r15"></span><br />
    |任务=<span id="r16"></span><br />
    |解锁等级=<span id="r18"></span><br />
    |特性=<span id="r19"></span><br />
    <span id="rg"></span>
    |一级={{模组/级<br />
    |等级=1<br />
    |基础数值=<span id="r1"></span><br />
    |天赋名=<span id="r2"></span><br />
    |天赋描述=<span id="r3"></span><br />
    |潜能效果=<span id="rqrr1"></span><br />
    |潜能等级=<span id="rqrr2"></span><br />
    |新增=<span id="rqrr3"></span><br />
    |解锁材料=<span id="r17"></span><br />
    }}<br />
    |二级={{模组/级<br />
    |等级=2<br />
    |基础数值=<span id="r5"></span><br />
    |天赋名=<span id="r6"></span><br />
    |天赋描述=<span id="r7"></span><br />
    |潜能效果=<span id="rqrr4"></span><br />
    |潜能等级=<span id="rqrr5"></span><br />
    |新增=<span id="rqrr6"></span><br />
    |升级材料=<span id="r8"></span><br />
    }}<br />
    |三级={{模组/级<br />
    |等级=3<br />
    |基础数值=<span id="r9"></span><br />
    |天赋名=<span id="r10"></span><br />
    |天赋描述=<span id="r11"></span><br />
    |潜能效果=<span id="rqrr7"></span><br />
    |潜能等级=<span id="rqrr8"></span><br />
    |新增=<span id="rqrr9"></span><br />
    |升级材料=<span id="r12"></span><br />
    }}<br />
    |描述=<span id="r13"></span><br />
    |材料总计=<span id="r22"></span><br />
    }}<br />
    <br />
  </div>
  <script src="/js/jQuery.js"></script>
  <script src="js/operator.js"></script>
  <script src="/js/cailiao.js"></script>
  <script src="/js/skTyp.js"></script>
  <script src="/js/skSpTyp.js"></script>
  <script src="/js/profLen.js"></script>
  <!-- <script src="/js/replaceStr.js"></script>
    -->
  <script src="js/stringReplace.js"></script>
  <script src="/js/rangeId.js"></script>
  <script src="/js/taicireplace.js"></script>
  <script src="/js/nationid.js"></script>
  <script src="/js/zhiye.js"></script>
  <script src="/js/skill.js"></script>
  <script src="/js/replaceAttribute.js"></script>
  <script src="/js/talent.js"></script>
  <script src="/js/format.js"></script>
  <script>
    //   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    //  !     模组 改为a1,a2 有第三模组就把a2改成第三个模组     !
    // !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    const uniequip = {
      "a1": {
        "uniEquipId": "uniequip_001_phatom",
        "uniEquipName": "傀影证章",
        "uniEquipIcon": "original",
        "uniEquipDesc": "干员傀影擅长反复切入战场\n根据外勤部门决议\n在外勤任务中划分为特种干员，行使处决者职责\n特别颁发此证章\n以兹证明",
        "typeIcon": "original",
        "typeName1": "ORIGINAL",
        "typeName2": null,
        "equipShiningColor": "grey",
        "showEvolvePhase": "PHASE_2",
        "unlockEvolvePhase": "PHASE_0",
        "charId": "char_250_phatom",
        "tmplId": null,
        "showLevel": 1,
        "unlockLevel": 0,
        "missionList": [],
        "unlockFavors": null,
        "itemCost": null,
        "type": "INITIAL",
        "uniEquipGetTime": 1635739200,
        "charEquipOrder": 0,
        "hasUnlockMission": false,
        "isSpecialEquip": false,
        "specialEquipDesc": null,
        "specialEquipColor": null
      },
      "a2": {
        "uniEquipId": "uniequip_004_phatom",
        "uniEquipName": "傀影特限证章",
        "uniEquipIcon": "uniequip_004_phatom",
        "uniEquipDesc": "干员傀影已获得特别认证许可根据外勤部门决议\n在集成战略行动中以改良策略应对敌人\n特别颁发此证章\n以兹证明\n“黑夜应当寂静，若有人伸手去撩那红幕布，砍断它。”",
        "typeIcon": "isw-a",
        "typeName1": "ISW",
        "typeName2": "A",
        "equipShiningColor": "purple",
        "showEvolvePhase": "PHASE_2",
        "unlockEvolvePhase": "PHASE_2",
        "charId": "char_250_phatom",
        "tmplId": null,
        "showLevel": 1,
        "unlockLevel": 60,
        "missionList": [],
        "unlockFavors": {
          "1": 0,
          "2": 2732,
          "3": 10070
        },
        "itemCost": {
          "1": [
            {
              "id": "mod_unlock_token",
              "count": 1,
              "type": "MATERIAL"
            }
          ],
          "2": [
            {
              "id": "mod_unlock_token",
              "count": 1,
              "type": "MATERIAL"
            }
          ],
          "3": [
            {
              "id": "mod_unlock_token",
              "count": 1,
              "type": "MATERIAL"
            }
          ]
        },
        "type": "ADVANCED",
        "uniEquipGetTime": 1722484800,
        "charEquipOrder": 4,
        "hasUnlockMission": false,
        "isSpecialEquip": true,
        "specialEquipDesc": "适配限定模式",
        "specialEquipColor": "0098dc"
      }
    }
























    //任务
    if (Boolean(uniequip.a1) == true) {
      df1.innerHTML = uniequip.a1.uniEquipName;
      df2.innerHTML = uniequip.a1.typeName1;
      df3.innerHTML = taicireplace(uniequip.a1.uniEquipDesc);
      $("#df4").html(operator(uniequip.a1.charId));
      $("#df5").html(operator(uniequip.a2.charId));
    }
    $.getJSON("/zh_CN/gamedata/excel/uniequip_table.json", function (uniequipMission1) {
      var id = [];
      var desc = [];
      for (x in uniequipMission1.missionList) {
        id.push(uniequipMission1.missionList[x].uniEquipMissionId);
        desc.push(uniequipMission1.missionList[x].desc);
      }
      for (let i = 0; i < id.length; i++) {
        if (uniequip.a2.missionList[0] == id[i]) {
          $("#r16").html(desc[i] + ";" + "&#60br/&#62");
          $("#a52").html(desc[i]);
        }
        if (uniequip.a2.missionList[1] == id[i]) {
          $("#r16").html($("#r16").html() + desc[i] + ";");
          $("#a53").html(desc[i]);
        }
      }
    });

    var time = new Date(uniequip.a1.uniEquipGetTime * 1000);
    var time2 = new Date(uniequip.a2.uniEquipGetTime * 1000);
    function checkTimeAvailble(obj) {
      if (obj < 10) {
        return "0" + obj;
      } else {
        return obj;
      }
    };
    // 时间
    $("#r25").html(time.getFullYear() + "年" +
      checkTimeAvailble(time.getMonth() + 1) + "月" +
      checkTimeAvailble(time.getDate()) + "日");
    $("#r23").html(time2.getFullYear() + "年" +
      checkTimeAvailble(time2.getMonth() + 1) + "月" +
      checkTimeAvailble(time2.getDate()) + "日");
    $("#r24").html($("#r23").html());
    //属性
    for (x in uniequip) {
      if (!uniequip[x].hasOwnProperty("phases") == true) {
        continue;
      }
      attReplace(uniequip[x].phases[0].attributeBlackboard[1].key) + "{{color|0098DC|+" + uniequip[x].phases[0].attributeBlackboard[1].value + "}}";
    }

    // 模组名
    $("#a51").html(uniequip.a2.uniEquipName);
    for (let i = 0; i < uniequip.a2.itemCost["1"].length; i++) {
      // 模组解锁材料
      $("#a54").html($("#a54").html() + "{{data|" + ms(uniequip.a2.itemCost['1'][i].id) + "|" + uniequip.a2.itemCost['1'][i].count + "}}");
    }

    // 名称   开始  结束
    function sliceStr(a1, a2, a3) {
      return a1.slice(a2, a3);
    }

    $.getJSON("/zh_CN/gamedata/excel/battle_equip_table.json", function (uniequipData1) {
      $.each(uniequipData1, function (i, v) {
        if (i == uniequip.a2.uniEquipId) {
          for (let i = 0; i < v.phases[0].attributeBlackboard.length; i++) {
            // 基础数值
            r1.innerHTML += attReplace(v.phases[0].attributeBlackboard[i].key) + "{{color|0098DC|" + " + " +
              v.phases[0].attributeBlackboard[i].value + "}}" + ",";
            a55.innerHTML += attReplace(v.phases[0].attributeBlackboard[i].key) + "{{color|0098DC|" + " + " +
              v.phases[0].attributeBlackboard[i].value + "}}" + "&#060;br/&#062;";
          }
          // 去除最后的点
          r1.innerHTML = sliceStr(r1.innerHTML, 0, -1);
          let basicText = "";
          for (let i = 0; i < v.phases[0].attributeBlackboard.length; i++) {
            // 基础数值2
            basicText += attReplace(v.phases[1].attributeBlackboard[i].key) + "{{color|0098DC|" + " + " +
              v.phases[1].attributeBlackboard[i].value + "}}" + ",";
          }
          $("#r5").html(basicText.slice(0, -1));
          basicText = "";
          for (let i = 0; i < v.phases[1].parts.length; i++) {
            if (v.phases[1].parts[i].addOrOverrideTalentDataBundle.candidates != null) {
              if (v.phases[1].parts[i].addOrOverrideTalentDataBundle.candidates[0].requiredPotentialRank == 0 &&
                v.phases[1].parts[i].addOrOverrideTalentDataBundle.candidates[0].name != null &&
                v.phases[1].parts[i].addOrOverrideTalentDataBundle.candidates[0].upgradeDescription != null) {
                // 天赋名2
                $("#r6").html(v.phases[1].parts[i].addOrOverrideTalentDataBundle.candidates[0].name);
                // 天赋描述2
                $("#r7").html(replaceStr(v.phases[1].parts[i].addOrOverrideTalentDataBundle.candidates[0].upgradeDescription));
                if (v.phases[1].parts[i].addOrOverrideTalentDataBundle.candidates[0].talentIndex == -1) {
                  $("#rqrr6").html("是");
                  $("#rqrr9").html("是");
                }
              }
              if (v.phases[1].parts[i].addOrOverrideTalentDataBundle.candidates?.[1]?.requiredPotentialRank != 0 &&
                v.phases[1].parts[i].addOrOverrideTalentDataBundle.candidates?.[1]?.name != null &&
                v.phases[1].parts[i].addOrOverrideTalentDataBundle.candidates?.[1]?.upgradeDescription != null) {
                // 潜能效果2
                $("#rqrr4").html(replaceStr(v.phases[1].parts[i].addOrOverrideTalentDataBundle.candidates?.[1].upgradeDescription));
                // 潜能等级2
                $("#rqrr5").html(v.phases[1].parts[i].addOrOverrideTalentDataBundle.candidates?.[1].requiredPotentialRank + 1);
              }
              continue;
            }
          }
          for (let i = 0; i < v.phases[2].attributeBlackboard.length; i++) {
            // 基础数值3
            basicText += attReplace(v.phases[2].attributeBlackboard[i].key) + "{{color|0098DC|" + " + " +
              v.phases[2].attributeBlackboard[i].value + "}}" + ",";
          }
          $("#r9").html(basicText.slice(0, -1));
          for (let i = 0; i < v.phases[1].parts.length; i++) {
            if (v.phases[2].parts[i].addOrOverrideTalentDataBundle.candidates != null) {
              if (v.phases[2].parts[i].addOrOverrideTalentDataBundle.candidates[0].requiredPotentialRank == 0 &&
                v.phases[2].parts[i].addOrOverrideTalentDataBundle.candidates[0].name != null &&
                v.phases[2].parts[i].addOrOverrideTalentDataBundle.candidates[0].upgradeDescription != null) {
                // 天赋名3
                $("#r10").html(v.phases[2].parts[i].addOrOverrideTalentDataBundle.candidates[0].name);
                // 天赋描述3
                $("#r11").html(replaceStr(v.phases[2].parts[i].addOrOverrideTalentDataBundle.candidates[0].upgradeDescription));
              }
              if (v.phases[2].parts[i].addOrOverrideTalentDataBundle.candidates?.[1]?.requiredPotentialRank != 0 &&
                v.phases[2].parts[i].addOrOverrideTalentDataBundle.candidates?.[1]?.name != null &&
                v.phases[2].parts[i].addOrOverrideTalentDataBundle.candidates?.[1]?.upgradeDescription != null) {
                // 潜能效果3
                $("#rqrr7").html(replaceStr(v.phases[2].parts[i].addOrOverrideTalentDataBundle.candidates?.[1].upgradeDescription));
                // 潜能等级3
                $("#rqrr8").html(v.phases[2].parts[i].addOrOverrideTalentDataBundle.candidates?.[1].requiredPotentialRank + 1);
              }
              continue;
            }
          }
          // 天赋名
          if ($("#rqrr6").html() != "是") {
            $("#r2").html($("#r6").html());
            // 天赋描述
            $("#r3").html(replaceStr(talents($("#r2").html())));
            // 潜能效果
            if (proTalents($("#r2").html()) != undefined) {
              $("#rqrr1").html(replaceStr(proTalents($("#r2").html())));
            }
            // 潜能等级
            $("#rqrr2").html(proRank($("#r2").html()) + 1);
          }


          // 特性
          let attut = {};
          for (let i = 0; i < v.phases[0].parts[0].overrideTraitDataBundle.candidates[0].blackboard.length; i++) {
            attut[v.phases[0].parts[0].overrideTraitDataBundle.candidates[0].blackboard[i].key] = v.phases[0].parts[0].overrideTraitDataBundle.candidates[0].blackboard[i].value;
          }
          // 新增特性
          let addTrait = v.phases[0].parts[0].overrideTraitDataBundle?.candidates[0].additionalDescription;
          // 特性更新
          let overrideTrait = v.phases[0].parts[0].overrideTraitDataBundle?.candidates[0].overrideDescripton;
          $("#r19").html(`${(addTrait != null) ? `{{#show:${operator(uniequip.a2.charId)}|?特性}}&#60;br/>` + replaceStr(addTrait).format(attut) : replaceStr(overrideTrait).format(attut)}`);
          r18.innerHTML = "精英化2 Lv." + v.phases[0].parts[0].overrideTraitDataBundle.candidates[0].unlockCondition.level;
          // 攻击范围
          if (v.phases[0].parts.length > 1) {
            if (v.phases[0].parts[1].addOrOverrideTalentDataBundle.candidates != null) {
              if (v.phases[0].parts[1].addOrOverrideTalentDataBundle.candidates[0].rangeId != null) {
                $("#rg").html("|攻击范围=" + rangeLen(v.phases[0].parts[1].addOrOverrideTalentDataBundle.candidates[0].rangeId) + "<br/>")
              }
            }
          }
        }
      });


      // 升级材料2
      for (let i = 0; i < uniequip.a2.itemCost['2'].length; i++) {
        r8.innerHTML += ms(uniequip.a2.itemCost['2'][i].id) + "*" + uniequip.a2.itemCost['2'][i].count + ",";
      }
      r8.innerHTML = sliceStr(r8.innerHTML, 0, -1);
      // 升级材料3
      for (let i = 0; i < uniequip.a2.itemCost['3'].length; i++) {
        r12.innerHTML += ms(uniequip.a2.itemCost['3'][i].id) + "*" + uniequip.a2.itemCost['3'][i].count + ",";
      }
      r12.innerHTML = sliceStr(r12.innerHTML, 0, -1);
      // 描述
      r13.innerHTML = taicireplace(uniequip.a2.uniEquipDesc);
      // 模组名
      r21.innerHTML = uniequip.a2.uniEquipName;
      r14.innerHTML = r21.innerHTML;
      // 模组类型
      r15.innerHTML = uniequip.a2.typeName1 + "-" + uniequip.a2.typeName2;
      // // 任务
      // 解锁材料
      for (let i = 0; i < uniequip.a2.itemCost['1'].length; i++) {
        r17.innerHTML += ms(uniequip.a2.itemCost['1'][i].id) + "*" + uniequip.a2.itemCost['1'][i].count + ",";
      }
      r17.innerHTML = sliceStr(r17.innerHTML, 0, -1);

      // a52.innerHTML = r16.innerHTML;

      a55.innerHTML = a55.innerHTML.slice(0, -11);
      a56.innerHTML = r19.innerHTML;

      // 默认模组


      // 材料总计
      // 数据块
      var modt = uniequip.a2.itemCost['1'][0].count +
        uniequip.a2.itemCost['2'][0].count +
        uniequip.a2.itemCost['3'][0].count;
      //龙门币
      let money,modt2,modt3
      if (!uniequip.a2.specialEquipDesc) {
         money = uniequip.a2.itemCost['1'][2].count +
          uniequip.a2.itemCost['2'][3].count +
          uniequip.a2.itemCost['3'][3].count;
        // 增补条
         modt2 = uniequip.a2.itemCost['2'][1].count;
        // 增补仪
         modt3 = uniequip.a2.itemCost['3'][1].count;
        // 合计
        r22.innerHTML = ms(uniequip.a2.itemCost['1'][0].id) + "*" + modt + "," +
          ms(uniequip.a2.itemCost['2'][1].id) + "*" + modt2 + "," +
          ms(uniequip.a2.itemCost['3'][1].id) + "*" + modt3 + "," +
          ms(uniequip.a2.itemCost['1'][1].id) + "*" + uniequip.a2.itemCost['1'][1].count + "," +
          ms(uniequip.a2.itemCost['2'][2].id) + "*" + uniequip.a2.itemCost['2'][2].count + "," +
          ms(uniequip.a2.itemCost['3'][2].id) + "*" + uniequip.a2.itemCost['3'][2].count + "," +
          ms(uniequip.a2.itemCost['3'][3].id) + "*" + money;
      }else{
        r22.innerHTML = ms(uniequip.a2.itemCost['1'][0].id) + "*" + modt;
      }
    })
    // equipId
    $("#l1").html(uniequip.a1.uniEquipId);
    $("#l2").html(uniequip.a2.uniEquipId);
    $("#sq1").html(uniequip.a1.uniEquipId.substr(uniequip.a1.uniEquipId.indexOf("_") + 3, 1) - 1);
    $("#sq2").html((uniequip.a2.uniEquipId.substr(uniequip.a2.uniEquipId.indexOf("_") + 3, 1)) - 1);
    $("#name0").html(operator(uniequip.a1.charId) + "/模组" + $("#sq1").html());
    $("#name1").html(operator(uniequip.a2.charId) + "/模组" + $("#sq2").html());
    function skill(obj) {
      switch (obj) {
        case 0:
          return "初始携带";
        case 1:
          return "精英化1";
        case 2:
          return "精英化2";
      }
    }

  </script>
</body>

</html>